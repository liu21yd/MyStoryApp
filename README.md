# 我的故事 (MyStoryApp)

一款基于AI的iOS应用，帮助用户将照片和文字转化为生动的短视频。

## 📸 界面预览

### 创作页面
- 输入故事标题和描述
- 选择视频风格（电影感/动漫/写实/梦幻/复古）
- 选择视频时长（10/30/60秒）
- 添加多个场景，每个场景可配图片、描述和情感标签

### 故事列表
- 查看所有创建的故事
- 按状态分类（草稿/生成中/已完成）
- 预览、分享、保存生成的视频

### 设置页面
- 配置 AI API Key
- 选择视频质量
- 管理存储空间

## 📱 功能特性

- **智能视频生成**: 使用可灵/即梦等AI API，将照片转化为流畅视频
- **多种风格**: 支持电影感、动漫、写实、梦幻、复古等多种风格
- **场景编辑**: 添加多个场景，每个场景可配文字和情感标签
- **灵活时长**: 支持10秒/30秒/60秒视频
- **一键分享**: 快速分享到社交媒体或保存到相册
- **草稿管理**: 自动保存未完成的作品

## 🛠️ 技术栈

- **语言**: Swift 5.9+
- **框架**: SwiftUI
- **最低系统**: iOS 16.0+
- **架构**: MVVM

## 📁 项目结构

```
MyStoryApp/
├── MyStoryApp/
│   ├── MyStoryApp.swift          # 应用入口
│   ├── Info.plist                # 应用配置
│   ├── Assets.xcassets/          # 资源文件
│   ├── Preview Content/          # 预览内容
│   ├── Views/                    # UI视图
│   │   ├── ContentView.swift     # 主界面
│   │   ├── CreateStoryView.swift # 创作页面
│   │   ├── MyStoriesView.swift   # 故事列表
│   │   ├── SettingsView.swift    # 设置页面
│   │   └── PPTVideoView.swift    # PPT视频生成器 ⭐️新增
│   ├── Models/                   # 数据模型
│   │   ├── StoryModels.swift     # 故事/场景模型
│   │   └── PPTVideoModels.swift  # PPT视频模型 ⭐️新增
│   └── Services/                 # 服务层
│       ├── StoryManager.swift    # 故事管理
│       ├── VideoGenerationService.swift  # 视频生成
│       ├── PPTVideoGenerator.swift       # PPT视频生成 ⭐️新增
│       └── PPTVideoManager.swift         # PPT视频管理 ⭐️新增
└── MyStoryApp.xcodeproj/         # Xcode项目

```

## 🚀 快速开始

### 1. 打开项目

在Xcode中打开 `MyStoryApp.xcodeproj`

### 2. 配置API Key

在 `VideoGenerationService.swift` 中替换API Key:

```swift
private let apiKey = "YOUR_KLING_API_KEY"
```

或在应用内的设置页面配置。

### 3. 获取API Key

#### 可灵 AI (推荐)
1. 访问 [可灵AI官网](https://klingai.com/)
2. 注册开发者账号
3. 申请API访问权限
4. 获取API Key

#### 即梦 AI
1. 访问 [即梦AI](https://dreamina.jianying.com/)
2. 申请API权限
3. 获取API Key

### 4. 运行项目

选择目标设备或模拟器，点击运行。

## 📋 使用指南

### 创作流程

1. **开始创作**
   - 点击底部"创作"标签
   - 输入故事标题和描述

2. **选择风格**
   - 选择视频风格（电影感/动漫/写实等）
   - 选择视频时长（10/30/60秒）

3. **添加场景**
   - 点击"添加场景"
   - 选择/拍摄照片
   - 输入场景描述
   - 选择情感标签

4. **生成视频**
   - 点击"生成视频"
   - 等待AI处理（通常1-5分钟）
   - 查看生成的视频

5. **分享保存**
   - 预览视频效果
   - 分享到社交媒体
   - 保存到相册

### 视频风格说明

| 风格 | 特点 | 适用场景 |
|------|------|----------|
| 电影感 | 专业调色、电影质感 | 重要时刻、旅行记录 |
| 动漫风 | 卡通渲染、色彩鲜艳 | 日常记录、趣味内容 |
| 写实风 | 自然真实、还原度高 | 生活记录、真实还原 |
| 梦幻风 | 柔和色调、朦胧美 | 浪漫场景、艺术创作 |
| 复古风 | 胶片颗粒、怀旧感 | 老照片、怀旧主题 |

## 🎬 PPT 视频生成器（新增功能）

将照片和文字一键转换为精美的 PPT 风格视频，支持 AI 图片扩展、配音和背景音乐。

### 功能特性

- **🖼️ AI 图片扩展**: 使用 Gemini AI 将图片智能扩展为视频素材
- **📝 智能字幕**: 自动添加描述文字，支持多种样式和动画
- **🗣️ AI 配音**: 文字转语音，支持多种声音类型
- **🎵 背景音乐**: 内置多种风格 BGM，自动混音
- **✨ 转场效果**: 支持淡入淡出、滑动、翻转等多种转场
- **🎨 多种风格**: 电影感、动漫风、写实风、梦幻风、复古风

### 使用流程

1. **添加幻灯片**
   - 点击右上角「+」选择照片
   - 可添加多张照片，长按拖动排序

2. **编辑幻灯片**
   - 点击幻灯片进入编辑
   - 添加字幕内容
   - 输入配音文本（可与字幕不同）
   - 设置显示时长（2-30秒）
   - 选择转场效果

3. **配置视频**
   - 选择分辨率（480p/720p/1080p/2K/4K）
   - 开启 AI 图片扩展
   - 选择配音类型
   - 选择背景音乐
   - 配置字幕样式

4. **生成视频**
   - 点击「生成视频」
   - 等待处理完成
   - 预览、分享或保存

### 技术实现

| 功能 | 技术方案 |
|------|----------|
| 图片扩展 | Gemini 3 Pro Image API |
| 语音合成 | Azure TTS / iOS Speech |
| 视频合成 | FFmpeg / AVFoundation |
| 字幕渲染 | FFmpeg drawtext / CATextLayer |
| 音频混音 | AVAudioMix |

### 文件格式支持

- **图片**: JPG, PNG, HEIC
- **输出视频**: MP4 (H.264)
- **音频**: AAC, MP3

## ⚙️ 配置选项

在设置页面可配置：

- **API选择**: 可灵/即梦/Runway等
- **API Key**: 个人API密钥
- **高清模式**: 是否生成更高质量视频
- **自动保存**: 退出时自动保存草稿

## 🔐 权限说明

应用需要以下权限：

- **相册访问**: 选择照片制作视频
- **相机权限**: 拍摄新照片
- **麦克风权限**: 录制音频（未来功能）
- **网络访问**: 调用AI API生成视频

## 🐛 故障排除

### 视频生成失败
1. 检查网络连接
2. 确认API Key正确
3. 查看API额度是否充足
4. 尝试重新生成

### 应用崩溃
1. 更新到最新iOS版本
2. 重启应用
3. 清除缓存（设置 → 存储管理 → 清除缓存）

## 📝 TODO

### 故事视频
- [x] 添加背景音乐选择
- [x] 支持自定义转场效果
- [ ] 添加视频编辑功能
- [ ] 支持批量生成
- [ ] 添加社区分享功能
- [ ] 支持更多AI API接入

### PPT视频生成器 ✅ 新增
- [x] 基础PPT视频生成功能
- [x] AI 图片扩展
- [x] AI 配音合成
- [x] 字幕渲染
- [x] 背景音乐混音
- [ ] 更多转场动画效果
- [ ] 自定义字体上传
- [ ] 视频模板市场
- [ ] 云端渲染加速

## 📄 许可证

MIT License

## 👨‍💻 开发者

OpenClaw AI

---

**注意**: 使用AI视频生成API会产生费用，请合理使用。
